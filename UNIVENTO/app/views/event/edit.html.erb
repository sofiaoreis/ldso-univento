<script src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
<link rel="stylesheet" type="text/css" href="/jquery-gmaps-latlon-picker.css"/>
<script src="/jquery-gmaps-latlon-picker.js"></script>
<script src="/ckeditor.js"></script>
<script src="/evento.js"></script>
<div class="row row-centered clearfix" id="eventos">
  <h1 class="text-center">Editar Evento</h1>
  <hr>
  <%= form_for(@event,:url => "/event/"<<params[:id] , :authenticity_token => true, :html => { :multipart => true }) do |f| %>
  <div>
    <div class="col-md-6 column">
        <div class="form-group">
          <div class="col-xs-8">
            <% if @event.errors[:name].any? %>
            <div class="btn btn-danger">
              <%= @event.errors[:name].first %>
            </div>
            <% end %><br>
            <label for="name">Name: </label>
            <%= f.text_field :name , :class=>"form-control"%>
          </div>
        </div>

        <div class="form-group">
          <div class="col-xs-8">
            <label for="preco">Preço total:</label>
            <% if @event.errors[:preco].any? %>
            <div class="btn btn-danger">
              <%= @event.errors[:preco].first %>
            </div>
            <% end %><br>
            <%= f.number_field :preco , :in => 0..999, :step => 0.01, :class=>"form-control"%><br>
          </div>
        </div>

        <div class="form-group">
          <div class="col-xs-8">
            <label for="descricao">Descrição:</label>
            <% if @event.errors[:descrition].any? %>
            <div class="btn btn-danger">
              <%= @event.errors[:descrition].first %>
            </div>
            <% end %><br>
            <%= f.text_area :descrition, :class=>"form-control", :row=>"3" %>
          </div>
        </div>

        <div class="form-group">
          <div class="col-xs-8">
            <label for="data_ativo">Data a partir da qual o evento fica activo:</label>
            <div class="input-group date" id="datetimepicker1">
              <input type="text" name="activeDate" class="form-control" value="<%=@event.activeDate%>">
              <span class="input-group-addon">
                <span class="glyphicon glyphicon-calendar"></span>
              </span>
            </div>
          </div>
        </div>

        <div class="form-group">
          <div class="col-xs-8">
            <label for="category">Categoria</label><br>
            <% @category.each_with_index do |category,index| %>
            <div class="row col-xs-8">
              <% if index == 0%>
              <%= radio_button_tag 'category', category.categoryID, @category == category, :checked => true %>
              <% else %>
              <%= radio_button_tag 'category', category.categoryID, @category == category %>
              <% end -%>
              <strong><%= category.name %></strong>
              <% category.tags.each do |tag| %>
              <div class="checkbox">
                <% if index == 0%>
                <label><%= check_box_tag 'tags[]', tag.tagsID, @tag == tag %><%= tag.name %></label>
                <% else %>
                <label hidden="true"><%= check_box_tag 'tags[]', tag.tagsID, @tag == tag %><%= tag.name %></label>
                <% end -%>
              </div>
              <% end %>
            </div>
            <% end %>  
          </div>
        </div>

        <div class="col-md-8">
          <div class="input-group">
            <% @event.youtube.each do |link| %>
              <span class="input-group-addon" id="basic-addon1"><i class="fa fa-youtube"></i></span>
            <%= text_field_tag 'youtube[]',link.videoID, :class=>"form-control", :placeholder=>"Youtube link" %>
            <% end %>
          </div>

          <div class="input-group">
          <% @event.spotify.each do |link| %>
            <span class="input-group-addon" id="basic-addon1"><i class="fa fa-spotify"></i></span>
            <%= text_field_tag 'spotify[]',link.playListLink, :class=>"form-control", :placeholder=>"Spotify link" %>
          <% end -%>
          </div>
        </div>

        <div class="form-group">
          <div class="col-xs-8">
            <label for="exampleInputFile">Inserir denovo as imagens, as existentes serão apagadas</label>
            <%= f.file_field :image, :multiple => true, name: "image[image][]" %>
          </div>
        </div>

      </form>
    </div>

    <div class="col-md-6 column">
      <div class="control-group" id="fields">
        <h4><strong>Preencha os detalhes para cada dia do evento:</strong></h4>
        <br>
        <div class="controls"> 
        <% @event.eventdate.each_with_index do |link, index| %>
            <div class="row entry input-group col-xs-8">
              <div class="form-group">
                <div class="col-xs-8">
                  <label for="data_ativo">Data de início:</label>
                  <div class="input-group date" id="">
                  <input name="dates[<%=index%>][startDate]" type="text" class="form-control" value="<%= link.startDate %>">
                    <span class="input-group-addon">
                      <span class="glyphicon glyphicon-calendar"></span>
                    </span>
                  </div>
                </div>
              </div>

              <div class="form-group">
                <div class="col-xs-8">
                  <label for="data_ativo">Data de fim:</label>
                  <div class="input-group date" id="">
                    <input name="dates[<%=index%>][endDate]" type="text" class="form-control" value="<%= link.endDate %>">
                    <span class="input-group-addon">
                      <span class="glyphicon glyphicon-calendar"></span>
                    </span>
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="form-group">
                  <div class="col-xs-4">
                    <label for="preco">Preço:</label>
                    <%= number_field_tag 'price[]',link.preco , :in => 0..999, :step => 0.01, :class=>"form-control"%>
                  </div>
                </div>
              </div>


              <div class="form-group">
                <label for="local">Escolha o local:</label>
                <fieldset class="gllpLatlonPicker" id="<%= index.to_s%>">
                  <input name="dates[<%=index%>][address]" value="<%= link.local.address %>" type="text" class="gllpSearchField">
                  <input type="button" class="gllpSearchButton" value="search">
                  <div class="gllpMap">Google Maps</div>
                  <input name="dates[<%=index%>][latitude]" type="hidden" class="gllpLatitude" value="<%= link.local.latitude %>"/>
                  <input name="dates[<%=index%>][longitude]" type="hidden" class="gllpLongitude" value="<%= link.local.longitude %>"/>
                  <input type="hidden" class="gllpZoom" value="12"/>
                </fieldset>
                <label for="descricao">Descrição da data:</label>
                <%= cktext_area :page, "info"<<index.to_s, :value => link.descrition, :ckeditor => {:uiColor => '#AADC6E', :toolbar => 'mini'} %>
                <br> 
               
              </div>
            </div>
            <% end %>
             <span class="input-group-btn" id="addDates">
                <button class="btn btn-success btn-add" type="button" >
                  <span class="glyphicon glyphicon-plus">Adicionar outra data</span>
                </button>
              </span>
        </div>
      </div>

      <div class="text-center">
        <%= f.submit 'Concluído', :class=>"btn btn-default mrg-bottom"%>
      </div>
    </div>

    <% end %>
  </div>
</div>